# Вопросы с собеседований на вакансию Pentester (Специалист по тестированию на проникновение)

## Оглавление
1. [Вопросы](#вопросы)
2. [Ответы](#ответы)
	
	1. [OWASP TOP 10.](#1-owasp-top-10)
		
		* [A01:2021-Broken Access Control](#a012021-broken-access-control)
		* [A02:2021-Cryptographic Failures](#a022021-cryptographic-failures)
		* [A03:2021-Injection](#a032021-injection)
		* [A04:2021-Insecure Design](#a042021-insecure-design)
		* [A05:2021-Security Misconfiguration](#a052021-security-misconfiguration)
		* [A06:2021-Vulnerable and Outdated Components](#a062021-vulnerable-and-outdated-components)
		* [A07:2021-Identification and Authentication Failures](#a072021-identification-and-authentication-failures)
		* [A08:2021-Software and Data Integrity Failures](#a082021-software-and-data-integrity-failures)
		* [A09:2021-Security Logging and Monitoring Failures](#a092021-security-logging-and-monitoring-failures)
		* [A10:2021-Server-Side Request Forgery](#a102021-server-side-request-forgery)
		
	2. [Как работает веб-сервис.](#2-как-работает-веб-сервис)
	3. [SQL-Injection.](#3-sql-injection)
	4. [Cross Site Scripting (XSS)](#4-cross-site-scripting-xss)
	5. [Path Treversal и File Inclusion.](#5-path-treversal-и-file-inclusion)
	6. [Опишите методику проведения пентеста.](#6-опишите-методику-проведения-пентеста)
	7. [Модель OSI и описание служб работающих на каждом уровне.](#7-модель-osi-и-описание-служб-работающих-на-каждом-уровне)
	8. [Известные вам методологии тестирования.](#8-известные-вам-методологии-тестирования)
	9. [Active Directory.](#9-active-directory)
	10. [Знание Windows и Linux.](#10-знание-windows-и-linux)
	11. [Пример системы для пентеста и описание полного алгоритма (логики проведения пентеста).](#11-пример-системы-для-пентеста-и-описание-полного-алгоритма-логики-проведения-пентеста)
	12. [Отчёт.](#12-отчёт)

3. [Практические задания](#практические-задания)
4. [Решения практических заданий](#решения-практических-заданий)

## Вопросы

1. OWASP TOP 10. 
	Знаете ли вы что такое OWASP TOP 10? Если да, расскажите про какой-либо из пунктов. В чем значимость этих уязвимостей. Типы подуязвимостей. Примеры.
2. Как работает веб-сервис.
	Опишите процессы, происходящие от ввода в URL строку google.com, до получение страницы поисковика (как работает веб-сервис?) Какие атаки на каждом из этапов могут быть реализованы?
3. SQL-Injection.
	Какие виды SQL-инъекций вы знаете? Расскажите о них.
4. Cross Site Scripting (XSS)
	* Какие виды XSS вы знаете? Расскажите о них.
	* Что отличает DOM XSS от хранимой XSS (помимо факта работы непосредственно с DOM)?
5. Path Treversal и File Inclusion
	Расскажите в чём разница между уязвимостями path treversal и file inclusion. Что опаснее и почему?
6. Опишите методику проведения пентеста.
	Указать этапы, набор утилит, которые вы будете использовать на каждом из этапов, а также пояснение, как вы будете использовать найденную на каждом из этапов информацию в дальнейшем.
7. Модель OSI и описание служб работающих на каждом уровне.
8. Известные вам методологии тестирования. Опишите их область применения и ключевые отличия.
9. Active Directory.
	* Что такое Active Directory? 
	* Для чего она нужна?
	* Зачем ее используют? (Для использования ролевых моделей) 
	* Что такое дерево и лес, как они формируются? 
	* Какие атаки на AD вам известны?
10. Знание Windows и Linux. 
	Вопросы по bash, демоны, логирование, администрирование, встроенные брендмауеры.
11. Пример системы для пентеста и описание полного алгоритма (логики проведения пентеста).
12. Отчёт.
	Что должно входить в отчет по результатам тестирования?

## Ответы

### 1. OWASP TOP 10.

(Знаете ли вы что такое OWASP TOP 10? Если да, расскажите про какой-либо из пунктов. В чем значимость этих уязвимостей. Типы подуязвимостей. Примеры.)

OWASP - Open Web Application Security Project (Открытый проект безопасности web-приложений) - это открытое сообщество, позволяющее организациям разрабатывать, приобретать и поддерживать безопасные приложения и интерфейсы прикладного программирования (API). Предоставляет стандарты, презентации, книги, видео, передовые исследования.

TOP 10 - Список из 10 самых популярных (часто встречающихся и опасных) уязвимостей в веб-приложениях. На 2021 год в них входят:

* А.01 - Недостатки контроля доступа (Broken Access Control). 94 % приложений были протестированы на предмет нарушения контроля доступа. 34 Common Weakness Enumerations (CWEs), сопоставленные с Broken Access Control, чаще встречаются в приложениях, чем любая другая категория.
* А.02 - Сбои криптографии (Cryptographic Failures), ранее "раскрытие конфиденциальных данных", что было общим симптомом, а не основной причиной. Особое внимание здесь уделяется сбоям, связанным с криптографией, которые часто приводят к раскрытию конфиденциальных данных или компрометации системы.
* А.03 - Внедрения (Injection). 94 % приложений были протестированы на наличие внедрений, и 33 CWE, сопоставленные с этой категорией, являются вторымипо частоте появления в приложениях.
* А.04 - Не безопасный дизайн (Inesecure Design). Категория, в которой основное внимание уделяется рискам, связанным с недостатками дизайна. Если мы действительно хотим «двигаться влево» как отрасль, это требует более широкого использования моделирования угроз, безопасных шаблонов и принципов проектирования, а также эталонных архитектур.
* А.05 - Некорректная настройка параметров безопасности (Security Misconfiguration). 90 % приложений были протестированы на наличие неправильной конфигурации. Рост встречаемости данной уязвимости связан с увеличением количества переходов на ПО с широкими возможностями настройки.
* А.06 - Уязвимые и устаревшие компоненты (Vulnerable and Outdated Components). Это единственная категория, в которой никакие распространенные уязвимости и воздействия (CVE) не сопоставлены с включенными CWE, поэтому в их оценках учитываются эксплойт и веса воздействия по умолчанию, равные 5,0.
* А.07 - Ошибки (Сбои) идентификации и аутентификации (Identification and Authentication Failures). Эта категория по-прежнему является неотъемлемой частью Топ-10, но, похоже, этому способствует повышенная доступность стандартизированных фреймворков. 
* А.08 - Сбои целостности программного обеспечения и данных (Software and Data Integrity Failures). Это новая категория, в которой основное внимание уделяется предположениям, связанным с обновлениями программного обеспечения, критическими данными и конвейерами CI/CD без проверки целостности. Одно из самых взвешенных воздействий данных Common Vulnerability and Exposures/Common Vulnerability Scoring System (CVE/CVSS), сопоставленных с 10 CWE в этой категории. Небезопасная десериализация из 2017 года теперь является частью этой более широкой категории.
* А.09 - Сбои ведения журнала и мониторинга безопасности (Security Logging and Monitoring Failures). Эта категория расширена за счет включения большего количества типов сбоев, сложна для тестирования и недостаточно хорошо представлена в данных CVE/CVSS. Однако сбои в этой категории могут напрямую повлиять на видимость, оповещение об инцидентах и судебную экспертизу.
* А.10 - Подделка запросов на стороне сервера (Server-Side Request Forgery - SSRF). Данные показывают относительно низкий уровень встречаемости данной уязвимости при охвате тестированием выше среднего, а также при потенциале использования и воздействия выше среднего. Эта категория представляет собой сценарий, в котором члены сообщества безопасности говорят нам, что это важно, хотя в настоящее время это не проиллюстрировано в данных.

------------------------------------------------------------

#### A01:2021-Broken Access Control 

[Source](https://owasp.org/Top10/A01_2021-Broken_Access_Control/)

Контроль доступом определяет политику разграничения доступа таким образом, чтобы пользователи не могули действовать за пределами своих предполагаемых полномочий. Сбои обычно приводят к НСД или к выполнению бизнес-функции за пределами полномочий пользователя. Общие уязвимости контроля доступа включают в себя:

* Нарушение принципа наименьших привилегий или запрета по умолчанию, (доступ предоставляется всем, когда должен предоставляться только для определенных задач, ролей или пользователей).
* Обход проверок управления доступом путем изменения URL-адреса (изменение параметров или принудительный просмотр), внутреннего состояния приложения или HTML-страницы либо с помощью инструмента атаки, изменяющего запросы API.
* Разрешение просмотра или редактирования чужой учётной записи путем предоставления ее уникального идентификатора (небезопасные прямые ссылки на объекты).
* Доступ к API без элементов управления доступом для POST, PUT и DELETE.
* Повышение привилегий. Работа в качестве пользователя без входа в систему или в качестве администратора при входе в систему в качестве пользователя.
* Манипуляции с метаданными, такие как воспроизведение или подделка маркера управления доступом JSON Web Token (JWT), а также использование файла cookie или скрытого поля для повышения привилегий или злоупотребления аннулированием JWT.
* Неправильная конфигурация CORS (Cross-origin resource sharing) разрешает доступ к API из неавторизованных/ненадежных источников.
* Принудительный просмотр аутентифицированных страниц в качестве неаутентифицированного пользователя или привилегированных страниц в качестве обычного пользователя.

Как предотвратить:

* Запрещать по умолчанию все ресурсы, за исключением общедоступных.
* Реализовать механизмы управления доступом один раз и повторно использовать их во всем приложении, включая минимизацию использования общего доступа к ресурсам между источниками (CORS).
* Элементы управления доступом должны обеспечивать закрепление прав собственности на записи, а не допускать, чтобы пользователь может создавать, читать, обновлять или удалять любую запись.
* Ограничивающие бизнес-требования к уникальным приложениям должны обеспечиваться моделями предметной области.
* Отключите список каталогов веб-сервера и убедитесь, что метаданные файлов (например, .git) и файлы резервных копий отсутствуют в корнях веб-сайтов.
* Регистрируйте сбои управления доступом, предупреждайте администраторов, когда это необходимо (например, повторяющиеся сбои).
* Ограничьте скорость доступа к API и контроллеру, чтобы свести к минимуму вред от автоматизированных инструментов атаки.
* Идентификаторы сеансов с отслеживанием состояния должны быть аннулированы на сервере после выхода из системы. Жетоны JWT без сохранения состояния должны быть недолговечными, чтобы свести к минимуму окно возможностей для злоумышленника. Для более долгоживущих JWT настоятельно рекомендуется следовать стандартам OAuth для отзыва доступа.

Для данного блока уязвимостей в OWASP определили 34 CWE (подробнее можно посмотреть в источнике), здесь же приведены наиболее простые/популярные:

* Path Traversal
* Permission Issuse
* Cross-Site Request Forgery (CSRF)
* Insecure Temporary File
* Open Redirect
* Missing/Incorrect Authorization

------------------------------------------------------------

#### A02:2021-Cryptographic Failures

[Source](https://owasp.org/Top10/A02_2021-Cryptographic_Failures/)

Прежде всего, необходимо определить потребности в защите данных при передаче и хранении. Например, пароли, номера кредитных карт, медицинские записи, личная информация и коммерческая тайна требуют дополнительной защиты, в основном, если эти данные подпадают под действие законов о конфиденциальности, например, Общего регламента ЕС по защите данных (GDPR), или нормативных актов, к примеру о защите финансовых данных, таких как, стандарт безопасности данных PCI (PCI DSS). 

Чем может провоцироваться уязвимость:

* Передача данных в открытом виде. Это касается таких протоколов, как HTTP, SMTP, FTP, а также использующих обновления TLS, такие как STARTTLS. Как во внутреннем взаимодействии, так и при работе с Интернетом.
* Использование старых или слабых криптографических алгоритмов или протоколы по умолчанию или в старом коде.
* Использование криптографических ключей по умолчанию, создание или повторное использование слабых криптографических ключей, или отсутствие надлежащего управление ключами или их ротации. 
* Наличие криптоключей в репозиториях исходного кода.
* Не использование шифрования там где это необходимо, например, отсутствуют какие-либо директивы безопасности HTTP-заголовков (браузера) или заголовки.
* Некорректно проверяется полученный сертификат сервера и цепочка доверия.
* Векторы инициализации игнорируются, используются повторно или создаются недостаточно безопасно для криптографического режима работы. Используется небезопасный режим работы, такой как ECB. Используется простое шифрование, когда шифрование с проверкой подлинности является более подходящим.
* Используются пароли в качестве криптографических ключей при отсутствии функции получения ключа на основе пароля.
* Используется случайность в криптографических целях, не предназначенных для удовлетворения криптографических требований. В правильной криптографической функции перезаписана разработчиком встроенная в нее надежную функция  заполнения исходным кодом, которому не хватает энтропии/непредсказуемости.
* Используются устаревшие хеш-функции, такие как MD5 или SHA1, или используются некриптографические хеш-функции, когда нужны криптографические хеш-функции.
* Используются устаревшие методы криптографического заполнения, такие как PKCS номер 1 v1.5.
* Неуместное использование сообщений об ошибках с криптографией или информационных сообщений по сторонним каналам, например, в форме атак оракула заполнения.

Как предотвратить:

* Классифицировать данные, обрабатываемые, сохраняемые или передаваемые приложением. Определите, какие данные являются конфиденциальными в соответствии с законами о конфиденциальности, нормативными требованиями или потребностями бизнеса.
* Не храните конфиденциальные данные без необходимости. Откажитесь от этого как можно скорее или используйте токенизацию или даже усечение в соответствии с PCI DSS. Данные, которые не сохраняются, не могут быть украдены.
* Обязательно зашифруйте все хранимые конфиденциальные данные.
* Обеспечьте наличие актуальных и надежных стандартных алгоритмов, протоколов и ключей; используйте правильное управление ключами.
* Шифруйте все передаваемые данные с помощью безопасных протоколов, таких как TLS с шифрованием прямой секретности (FS), приоритезацией шифров сервером и безопасными параметрами. Обеспечьте шифрование с помощью таких директив, как HTTP Strict Transport Security (HSTS).
* Отключите кэширование ответов, содержащих конфиденциальные данные.
* Примените необходимые меры безопасности в соответствии с классификацией данных.
* Не используйте устаревшие протоколы, такие как FTP и SMTP, для передачи конфиденциальных данных.
* Храните пароли, используя надежные адаптивные и соленые функции хеширования с коэффициентом работы (коэффициентом задержки), например Argon2, scrypt, bcrypt или PBKDF2.
* Всегда используйте шифрование с проверкой подлинности (аутентифицированное), а не просто шифрование.
* Ключи должны генерироваться криптографически случайным образом и храниться в памяти в виде массивов байтов. Если используется пароль, то он должен быть преобразован в ключ с помощью соответствующей функции получения базового ключа пароля.
* Избегайте устаревших криптографических функций и схем заполнения, таких как MD5, SHA1, PKCS номер 1 v1.5.
* Самостоятельно проверяйте эффективность конфигурации и настроек.

Для данного блока уязвимостей в OWASP определили 29 CWE (подробнее можно посмотреть в источнике), здесь же приведены наиболее простые/популярные:

* Weak Encoding for Password
* Cryptographic Issuse
* Use of Hard-coded Cyptographic Key
* Use of a Broken or Risky Cryptographic Algorithm
* Unprotected Transport of Credentials
* Use of a One-Way Hash without a Salt (or Predictable Salt)

------------------------------------------------------------

#### A03:2021-Injection

[Source](https://owasp.org/Top10/A03_2021-Injection/)

Приложение уязвимо для атаки, когда:

* Введенные пользователем данные не проверяются, не фильтруются и не очищаются приложением.
* Динамические запросы или непараметризованные вызовы без контекстно-зависимого экранирования используются непосредственно в интерпретаторе.
* Враждебные данные используются в параметрах поиска объектно-реляционного сопоставления (ORM) для извлечения дополнительных конфиденциальных записей.
* Враждебные данные используются напрямую или объединяются. SQL или команда содержат структуру и вредоносные данные в динамических запросах, командах или хранимых процедурах.

Некоторые из наиболее распространенных инъекций (внедрений) — SQL, NoSQL, команда ОС, реляционное сопоставление объектов (ORM), LDAP и внедрение языка выражений (EL) или библиотеки навигации по графу объектов (OGNL). 

Концепция одинакова среди всех интерпретаторов. Проверка исходного кода — лучший способ определить, уязвимы ли приложения для инъекций. 

Настоятельно рекомендуется автоматическое тестирование всех параметров, заголовков, URL-адресов, файлов cookie, входных данных JSON, SOAP и XML. Организации могут включать статические (SAST), динамические (DAST) и интерактивные (IAST) инструменты тестирования безопасности приложений в конвейер CI/CD, чтобы выявлять внедренные недостатки перед развертыванием в рабочей среде.

Как предотвратить:

* Предпочтительным вариантом является использование безопасного API, который полностью исключает использование интерпретатора, предоставляет параметризованный интерфейс или переходит на средства объектно-реляционного сопоставления (ORM).
	_Примечание_. Даже если хранимые процедуры параметризованы, они все равно могут привести к SQL-инъекциям, если PL/SQL или T-SQL объединяют запросы и данные или выполняют враждебные данные с помощью EXECUTE IMMEDIATE или exec().
* Используйте положительную проверку ввода на стороне сервера. Это не полная защита, так как многие приложения требуют специальных символов, таких как текстовые области или API для мобильных приложений.
* Для любых остаточных динамических запросов экранируйте специальные символы, используя специальный синтаксис escape для этого интерпретатора.
	_Примечание_. Структуры SQL, такие как имена таблиц, имена столбцов и т. д., не могут быть экранированы, поэтому имена структур, предоставляемые пользователем, опасны. Это распространенная проблема в программном обеспечении для написания отчетов.
* Используйте LIMIT и другие элементы управления SQL в запросах, чтобы предотвратить массовое раскрытие записей в случае внедрения SQL.

Для данного блока уязвимостей в OWASP определили 33 CWE (подробнее можно посмотреть в источнике), здесь же приведены наиболее простые/популярные:

* SQL and NoSQL Injection
* Cross Site Scripting (XSS)
* Command Injection and OS Command Injection
* CRLF Injection
* XPath Injection
* Unsafe Reflection

------------------------------------------------------------

#### A04:2021-Insecure Design

[Source](https://owasp.org/Top10/A04_2021-Insecure_Design/)

Небезопасный дизайн — это широкая категория, представляющая различные недостатки, выраженные как «отсутствующий или неэффективный дизайн элемента управления». Небезопасный дизайн не является источником всех остальных 10 категорий риска. Есть разница между небезопасным дизайном и небезопасной реализацией. Мы различаем недостатки дизайна и дефекты реализации по той причине, что у них разные первопричины и методы исправления. Безопасный дизайн все еще может иметь дефекты реализации, приводящие к уязвимостям, которые могут быть использованы. Небезопасный дизайн не может быть исправлен идеальной реализацией, поскольку по определению необходимые средства безопасности никогда не создавались для защиты от конкретных атак. Одним из факторов, способствующих небезопасному проектированию, является отсутствие профилирования бизнес-рисков, присущего разрабатываемому программному обеспечению или системе, и, следовательно, невозможность определить, какой уровень безопасности требуется.

Безопасный дизайн — это культура и методология, которые постоянно оценивают угрозы и обеспечивают надежную разработку и тестирование кода для предотвращения известных методов атак. Моделирование угроз должно быть интегрировано в сеансы уточнения (или аналогичные действия); ищите изменения в потоках данных и управлении доступом или других мерах безопасности.

Для безопасного программного обеспечения требуется безопасный жизненный цикл разработки, некоторая форма безопасного шаблона проектирования, методология проложенной дороги, защищенная библиотека компонентов, инструменты и моделирование угроз. Обратитесь к своим специалистам по безопасности в начале проекта программного обеспечения на протяжении всего проекта и обслуживания вашего программного обеспечения. Рассмотрите возможность использования модели OWASP Software Assurance Maturity Model (SAMM), чтобы структурировать свои усилия по разработке безопасного программного обеспечения.

Как предотвратить:

* Создайте и используйте безопасный жизненный цикл разработки вместе со специалистами AppSec, чтобы помочь оценить и разработать элементы управления, связанные с безопасностью и конфиденциальностью.
* Создавайте и используйте библиотеку безопасных шаблонов проектирования или готовых к использованию компонентов асфальтированной дороги.
* Используйте моделирование угроз для критической аутентификации, управления доступом, бизнес-логики и ключевых потоков.
* Интегрируйте язык безопасности и элементы управления в пользовательские истории.
* Интегрируйте проверки правдоподобия на каждом уровне вашего приложения (от интерфейса до сервера).
* Напишите модульные и интеграционные тесты, чтобы убедиться, что все критические потоки устойчивы к модели угроз. Скомпилируйте варианты использования и варианты неправильного использования для каждого уровня вашего приложения.
* Разделяйте многоуровневые уровни на системные и сетевые уровни в зависимости от требований к воздействию и защите.
* Надежно разделяйте арендаторов по дизайну на всех уровнях.
* Ограничить потребление ресурсов пользователем или службой.

Для данного блока уязвимостей в OWASP определили 40 CWE (подробнее можно посмотреть в источнике), здесь же приведены наиболее простые/популярные:

* Generation of Error Message Containing Sensitive Information
* Unprotected Storage of Credentials
* Use of Web Browser Cache/ Persistent Cookies Containing Sensitive Information
* External Control of Critical State Data
* Trusting HTTP Permition Methods on the Server Side
* Business Logic Error

------------------------------------------------------------

#### A05:2021-Security Misconfiguration

[Source](https://owasp.org/Top10/A05_2021-Security_Misconfiguration/)

Приложение может быть уязвимым, если в нём:

* Отсутствует надлежащее усиление безопасности в любой части стека приложений или неправильно настроены разрешения для облачных сервисов.
* Включены или установлены ненужные функции (например, ненужные порты, службы, страницы, учетные записи или привилегии).
* Учетные записи по умолчанию и их пароли по-прежнему включены и не изменяются.
* Обработка ошибок показывает трассировку стека или другие слишком информативные сообщения об ошибках для пользователей.
* В обновленных системах последние функции безопасности отключены или настроены небезопасно.
* Параметры безопасности на серверах приложений, платформах приложений (например, Struts, Spring, ASP.NET), библиотеках, базах данных и т.д. не устанавливаются в безопасные значения.
* Сервер не отправляет заголовки или директивы безопасности, или для них не установлены безопасные значения.
* Программное обеспечение устарело или уязвимо (см. A06:2021 — Уязвимые и устаревшие компоненты).

Как предотвратить:

* Повторяемый процесс усиления безопасности позволяет быстро и легко развернуть другую среду, которая должным образом заблокирована. Среды разработки, контроля качества и производства должны быть настроены одинаково, с использованием разных учетных данных в каждой среде. Этот процесс следует автоматизировать, чтобы свести к минимуму усилия, необходимые для настройки новой безопасной среды.
* Минимальная платформа без лишних функций, компонентов, документации и примеров. Удалите или не устанавливайте неиспользуемые функции и платформы.
* Задача по просмотру и обновлению конфигураций, соответствующих всем примечаниям, обновлениям и исправлениям безопасности, в рамках процесса управления исправлениями (см. A06:2021 — Уязвимые и устаревшие компоненты). Проверьте разрешения облачного хранилища (например, разрешения корзины S3).
* Сегментированная архитектура приложений обеспечивает эффективное и безопасное разделение между компонентами или арендаторами с помощью сегментации, контейнеризации или облачных групп безопасности (ACL).
* Отправка директив безопасности клиентам, например, заголовков безопасности.
* Автоматизированный процесс проверки эффективности конфигураций и настроек во всех средах.

Для данного блока уязвимостей в OWASP определили 20 CWE (подробнее можно посмотреть в источнике), здесь же приведены наиболее простые/популярные:

* Password in Configuration File
* .NET Misconfigurations
* Use a hard-coded, Security-relevant Constants
* Missing Custom Error Page
* Sensitive Cookie Without "HttpOnly" Flag
* CWE-16 Configuration

------------------------------------------------------------

#### A06:2021-Vulnerable and Outdated Components

[Source](https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/)

Возникают когда:

* Вы не знаете версии всех используемых вами компонентов (как на стороне клиента, так и на стороне сервера). Сюда входят компоненты, которые вы используете напрямую, а также вложенные зависимости.
* ПО уязвимо, не поддерживается или устарело. Сюда входят ОС, веб-сервер/сервер приложений, система управления базами данных (СУБД), приложения, API и все компоненты, среды выполнения и библиотеки.
* Вы не выполняете регулярное сканирование на наличие уязвимостей и не подписываетесь на бюллетени по безопасности, связанные с используемыми вами компонентами.
* Вы не исправляете или не обновляете базовую платформу, фреймворки и зависимости своевременно и с учетом рисков. Это обычно происходит в средах, когда исправление является ежемесячной или ежеквартальной задачей под контролем изменений, что оставляет организации открытыми для дней или месяцев ненужного воздействия на уязвимости, которые могут быть исправлены.
* Разработчики ПО не проверяют совместимость обновленных, модернизированных или исправленных библиотек.
* Вы не защищаете конфигурации компонентов (см. A05:2021-Security Misconfiguration).

Как предотвратить:

* Удалите неиспользуемые зависимости, ненужные функции, компоненты, файлы и документацию.
* Постоянно проводите инвентаризацию версий как клиентских, так и серверных компонентов (например, фреймворков, библиотек) и их зависимостей, используя такие инструменты, как версии, OWASP Dependency Check, retire.js и т.д. Непрерывно отслеживайте такие источники, как Common Vulnerability and Exposures (CVE) и Национальная база данных уязвимостей (NVD) для уязвимостей в компонентах. Используйте инструменты анализа состава программного обеспечения для автоматизации процесса. Подпишитесь на оповещения по электронной почте об уязвимостях безопасности, связанных с используемыми вами компонентами.
* Получайте компоненты только из официальных источников по безопасным ссылкам. Отдавайте предпочтение подписанным пакетам, чтобы снизить вероятность включения модифицированного вредоносного компонента (см. A08:2021 — Сбои целостности программного обеспечения и данных).
* Отслеживайте библиотеки и компоненты, которые не поддерживаются или не создают исправления безопасности для более старых версий. Если исправление невозможно, рассмотрите возможность развертывания виртуального исправления для мониторинга, обнаружения или защиты от обнаруженной проблемы.

Для данного блока уязвимостей в OWASP определили 3 CWE:

* CWE-937 OWASP Top 10 2013: Using Components with Known Vulnerabilities
* CWE-1035 2017 Top 10 A9: Using Components with Known Vulnerabilities
* CWE-1104 Use of Unmaintained Third Party Components

------------------------------------------------------------

#### A07:2021-Identification and Authentication Failures

[Source](https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/)

Подтверждение личности пользователя, проверка подлинности и управление сеансом имеют решающее значение для защиты от атак, связанных с проверкой подлинности. Возможны недостатки аутентификации, если приложение:

* Разрешает автоматические атаки, такие как вброс учетных данных, когда у злоумышленника есть список действительных имен пользователей и паролей.
* Разрешает грубую силу (перебор) или другие автоматизированные атаки.
* Разрешает использование стандартных, слабых или хорошо известных паролей, таких как «Password1» или «admin/admin».
* Использует слабые или неэффективные процессы восстановления учетных данных и забытого пароля, такие как «ответы, основанные на знаниях», которые нельзя сделать безопасными.
* Использует простые текстовые, зашифрованные или слабо хешированные хранилища данных паролей (см. A02:2021-Криптографические сбои).
* Не использует или использует неэффективную многофакторнаю аутентификацию (MFA).
* Предоставляет идентификатор сеанса в URL-адресе.
* Повторно использует идентификатор сеанса после успешного входа в систему.
* Неправильно аннулирует идентификаторы сеанса. Сеансы пользователей или маркеры проверки подлинности (в основном маркеры единого входа (SSO)) не аннулируются должным образом во время выхода из системы или периода бездействия.

Как предотвратить:

* По возможности внедрите многофакторную аутентификацию.
* Не отправляйте и не развертывайте с какими-либо учетными данными по умолчанию.
* Внедряйте проверку слабых паролей.
* Приведите политики длины, сложности и ротации паролей в соответствие с рекомендациями Национального института стандартов и технологий (NIST) 800-63b в разделе 5.1.1 для запомненных секретов или другими современными политиками паролей, основанными на фактических данных.
* Убедитесь, что регистрация, восстановление учетных данных и пути API защищены от атак с перечислением учетных записей, используя одни и те же сообщения для всех результатов.
* Ограничьте или задержите неудачные попытки входа в систему, но будьте осторожны, чтобы не создать сценарий отказа в обслуживании. Регистрируйте все сбои и оповещайте администраторов при обнаружении подмены учетных данных, грубой силы или других атак.
* Используйте безопасный встроенный диспетчер сеансов на стороне сервера, который генерирует новый случайный идентификатор сеанса с высокой энтропией после входа в систему. Идентификатор сеанса не должен быть в URL-адресе, должен быть надежно сохранен и аннулирован после выхода из системы, бездействия и абсолютного тайм-аута.

Для данного блока уязвимостей в OWASP определили 22 CWE (подробнее можно посмотреть в источнике), здесь же приведены наиболее простые/популярные:

* Use of Hard-coded Password
* Missing Critical Step in Authentication
* Unverified Password Change
* Session Fixation
* Authentication Bypasses
* Improper Validation of Certificate with Host Mismatch

------------------------------------------------------------

#### A08:2021-Software and Data Integrity Failures

[Source](https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/)

Сбои целостности программного обеспечения и данных связаны с кодом и инфраструктурой, которые не защищают от нарушений целостности. 

Примером этого является ситуация, когда приложение использует плагины, библиотеки или модули из ненадежных источников, репозиториев и сетей доставки контента (CDN). Небезопасный конвейер CI/CD может привести к несанкционированному доступу, вредоносному коду или компрометации системы. Наконец, многие приложения теперь включают функцию автоматического обновления, при которой обновления загружаются без достаточной проверки целостности и применяются к ранее доверенному приложению. Злоумышленники потенциально могут загружать свои собственные обновления для распространения и запуска на всех установках. 

Другой пример — когда объекты или данные закодированы или сериализованы в структуру, которую злоумышленник может увидеть и изменить, она уязвима для небезопасной десериализации.

Как предотвратить:

* Используйте цифровые подписи или аналогичные механизмы для проверки того, что программное обеспечение или данные получены из ожидаемого источника и не были изменены.
* Убедитесь, что библиотеки и зависимости, такие как npm или Maven, используют доверенные репозитории. Если у вас профиль с более высоким риском, рассмотрите возможность размещения проверенного внутреннего заведомо исправного репозитория.
* Убедитесь, что инструмент безопасности цепочки поставок программного обеспечения, такой как OWASP Dependency Check или OWASP CycloneDX, используется для проверки того, что компоненты не содержат известных уязвимостей.
* Убедитесь, что существует процесс проверки изменений кода и конфигурации, чтобы свести к минимуму вероятность того, что вредоносный код или конфигурация могут быть внедрены в конвейер вашего программного обеспечения.
* Убедитесь, что ваш конвейер CI/CD имеет надлежащее разделение, конфигурацию и контроль доступа, чтобы обеспечить целостность кода, проходящего через процессы сборки и развертывания.
* Убедитесь, что неподписанные или незашифрованные сериализованные данные не отправляются ненадежным клиентам без какой-либо формы проверки целостности или цифровой подписи для обнаружения подделки или воспроизведения сериализованных данных.

Для данного блока уязвимостей в OWASP определили 10 CWE:

* CWE-345 Insufficient Verification of Data Authenticity
* CWE-353 Missing Support for Integrity Check
* CWE-426 Untrusted Search Path
* CWE-494 Download of Code Without Integrity Check
* CWE-502 Deserialization of Untrusted Data
* CWE-565 Reliance on Cookies without Validation and Integrity Checking
* CWE-784 Reliance on Cookies without Validation and Integrity Checking in a Security Decision
* CWE-829 Inclusion of Functionality from Untrusted Control Sphere
* CWE-830 Inclusion of Web Functionality from an Untrusted Source
* CWE-915 Improperly Controlled Modification of Dynamically-Determined Object Attributes

------------------------------------------------------------

#### A09:2021-Security Logging and Monitoring Failures

[Source](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/)

Для данного блока уязвимостей в OWASP определили 4 CWE:

* CWE-117 Improper Output Neutralization for Logs
* CWE-223 Omission of Security-relevant Information
* CWE-532 Insertion of Sensitive Information into Log File
* CWE-778 Insufficient Logging

------------------------------------------------------------

#### A10:2021-Server-Side Request Forgery

[Source](https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/

Для данного блока уязвимостей в OWASP определили 1 CWE:

* CWE-918 Server-Side Request Forgery (SSRF)
------------------------------------------------------------

### 2. Как работает веб-сервис.
	(Опишите процессы, происходящие от ввода в URL строку google.com, до получение страницы поисковика. Какие атаки на каждом из этапов могут быть реализованы?)

### 3. SQL-Injection.
	Какие виды SQL-инъекций вы знаете? Расскажите о них.

### 4. Cross Site Scripting (XSS)
	* Какие виды XSS вы знаете? Расскажите о них.
	* Что отличает DOM XSS от хранимой XSS (помимо факта работы непосредственно с DOM)?

### 5. Path Treversal и File Inclusion.
	Расскажите в чём разница между уязвимостями path treversal и file inclusion. Что опаснее и почему?

### 6. Опишите методику проведения пентеста. 
	Указать этапы, набор утилит, которые вы будете использовать на каждом из этапов, а также пояснение, как вы будете использовать найденную на каждом из этапов информацию в дальнейшем.

### 7. Модель OSI и описание служб работающих на каждом уровне.

### 8. Известные вам методологии тестирования.
	Опишите их область применения и ключевые отличия.

### 9. Active Directory.
	* Что такое Active Directory? 
	* Для чего она нужна? 
	* Зачем ее используют?
	* Что такое дерево и лес, как они формируются?
	* Какие атаки на AD вам известны? (app-pass-the-hesh? woulden_tiket? kpk-accaunt (kerberos)?)

### 10. Знание Windows и Linux. 
	Вопросы по bash, демоны, логирование, администрирование, встроенные брендмауеры.

### 11. Пример системы для пентеста и описание полного алгоритма (логики проведения пентеста).

### 12. Отчёт.
	Что должно входить в отчет по результатам тестирования?


## Практические задания

1. Вам выдан доступ к удаленной станции по VPN. Ваша задача залогиниться на коммутаторе с IP-адресом _таким-то_ под пользователем _admin_. Брутить пароль бессмысленно, он длинный и сложный. Сканирование портов блокируется на 10 секунд.
2. Вам дан дамп сетевого трафика снятый между клиентом и веб-сервером. Первичная аутентификация строиться на основании HTTP аутентификации. Проверьте безопасно ли реализована аутентификация и получите передаваемые данные.

## Решения практических заданий
